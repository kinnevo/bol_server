[build]
builder = "NIXPACKS"

[build.env]
NODE_ENV = "production"

[deploy]
# Run migrations in background, then start server
# Use || true to continue even if migrations fail (they might already be run)
startCommand = "npm run migrate:up || true && npm start"
# Use a simpler healthcheck endpoint
healthcheckPath = "/api/server-config"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
